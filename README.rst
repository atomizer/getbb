getbb
=====
Этот скрипт позволяет извлечь исходный код оформления со страницы
одного из поддерживаемых трекеров, автоматически перенося все
изображения на локальный хостинг (сейчас это http://file.kirovnet.ru/).

Поддерживаемые на данный момент трекеры:

- rutracker.org
- epidemz.net
- hdclub.org
- pirat.ca

Если не знаете, с чего начать
-----------------------------
Здесь предполагается, что у вас Win\*. Пользователи \*nix
переходят к следующему разделу.

Подготовка:

1. Для начала вам понадобится Python_ (2.x).
2. Скачайте архив со скриптами, нажав на большую кнопку "Файлы"
   ("Downloads") cверху справа от этого текста.
3. Распакуйте архив в отдельную папочку. 
   Для удобства можно сделать ярлыки к файлам
   ``getbb.py`` и ``rehost.py`` и положить их поудобнее,
   а сами файлы оставить в покое.

Использование:

1. Сохраните страницу, откуда хотите взять оформление, себе на диск.
2. Бросьте мышкой (drag&drop) файл страницы на файл ``getbb.py``
   (или на ярлык).
3. После завершения процесса откроется блокнот с текстом оформления.

Если что-то пошло не так, используйте консоль.
Если всё совсем плохо, свяжитесь со мной.

.. _Python: http://python.org/download/

Интерфейс командной строки
--------------------------
::

    python getbb.py input [output]

input
    ссылка на целевую страницу или путь к соответствующему HTML-файлу.

output
    опциональное имя текстового файла, в который выводится код
    оформления (по умолчанию ``out.txt``).

Дополнительные фичи
-------------------

Параллельная загрузка
~~~~~~~~~~~~~~~~~~~~~
В `getbb` встроена поддержка многопоточной загрузки изображений, что
значительно ускоряет процесс переноса изображений на локальный хостинг.

Для того, чтобы эта фича заработала, достаточно установить gevent_.

.. _gevent: http://www.gevent.org/

Исправление миниатюр
~~~~~~~~~~~~~~~~~~~~
В некоторых исходниках иногда в качестве миниатюр используются либо сами
изображения (при этом "миниатюрами" они сделаны через CSS-свойства),
либо слишком мелкие/обрезанные картинки. В таких случаях возможна
автоматическая генерация новых, качественных миниатюр.

Для того, чтобы эта фича заработала, достаточно установить
Python Imaging Library (PIL) (бинарники для винды - здесь__).

__ http://effbot.org/downloads/#pil

rehost
======
Этот скрипт может работать отдельно от ``getbb`` в качестве
быстрого способа закинуть файл-другой на file.kirovnet.ru.

Под виндой работает drag&drop.

Интерфейс командной строки::

    python rehost.py file1 [file2] ...
  
fileN
    адреса файлов (не обязательно локальные).
    
Разработчикам и сочувствующим
=============================
Примерный список того, что можно сделать:

- придумать формат для правил замены, вынести их в отдельный файл
- переписать под BeautifulSoup или lxml
  (я не хотел зависеть от сторонних библиотек, поэтому
  парсинг HTML написан вручную на регэкспах).
- переписать под python3k с сохранением совместимости
  (но gevent пока только для 2.x?)
- обернуть парсинг командной строки в optparse_/argparse_,
  добавить опций (``--no-rehost``, ``--no-open`` и пр.)
- GUI
- ...

Если у кого-то есть желание сделать что-нибудь
(неважно, из этого списка или нет), делайте форк или шлите патч.
Желательно соблюдать, по возможности, PEP8_ и писать комментарии
по-английски.

.. _PEP8: http://www.python.org/dev/peps/pep-0008/
.. _argparse: http://docs.python.org/dev/library/argparse.html
.. _optparse: http://docs.python.org/dev/library/optparse.html

Контакты
========
Если у вас есть, что сказать, можно `написать мне в личку`__
или постучаться в IRC (irc.kirovnet.ru #megapirat).

__ http://kirovmedia.net/forum/privmsg.php?mode=post&u=6591
